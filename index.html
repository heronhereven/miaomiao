<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="å–µå–µå–æ°´">
    <title>å–µå–µå–æ°´ - Pixel Cat Water Reminder</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&family=Noto+Sans+SC:wght@400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #FF6B9D;
            --secondary: #C44569;
            --accent: #FFA502;
            --bg: #FFF5E4;
            --cat-color: #FFD93D;
            --window-bg: #87CEEB;
            --carpet: #C23B22;
            --plant: #6BCB77;
            --text: #2C3E50;
            --success: #6BCB77;
            --warning: #FFA502;
        }
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: var(--bg);
            overflow-x: hidden;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .app-container {
            max-width: 420px;
            margin: 0 auto;
            min-height: 100vh;
            background: white;
            box-shadow: 0 0 40px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        .top-nav {
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            background: white;
            border-bottom: 3px solid #2C3E50;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 8px 20px;
            border-radius: 12px;
            transition: all 0.3s;
            position: relative;
        }
        
        .nav-btn.active {
            background: var(--primary);
            transform: scale(1.1);
        }
        
        .nav-btn.active::after {
            content: '';
            position: absolute;
            bottom: -18px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid var(--primary);
        }
        
        /* é¡µé¢å®¹å™¨ */
        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ä¸»é¡µé¢ - çŒ«å’ªæˆ¿é—´ */
        .home-page {
            padding: 20px;
            min-height: calc(100vh - 80px);
            background: linear-gradient(to bottom, var(--bg) 0%, #FFE5B4 100%);
            position: relative;
        }
        
        /* çª—æˆ· */
        .window {
            width: 100%;
            height: 140px;
            background: var(--window-bg);
            border: 6px solid #8B4513;
            border-radius: 12px 12px 0 0;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 30px rgba(255,255,255,0.3);
        }
        
        .window::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 6px;
            background: #8B4513;
            transform: translateY(-50%);
        }
        
        .window::after {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 6px;
            background: #8B4513;
            transform: translateX(-50%);
        }
        
        .clouds {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            height: 40px;
        }
        
        .cloud {
            position: absolute;
            background: white;
            border-radius: 50px;
            opacity: 0.7;
            animation: float 20s infinite linear;
        }
        
        .cloud:nth-child(1) {
            width: 60px;
            height: 20px;
            top: 10px;
            left: -60px;
        }
        
        .cloud:nth-child(2) {
            width: 80px;
            height: 25px;
            top: 30px;
            left: -100px;
            animation-delay: 7s;
        }
        
        @keyframes float {
            to { transform: translateX(500px); }
        }
        
        /* æˆ¿é—´å†…å®¹ */
        .room-content {
            margin-top: 30px;
            position: relative;
        }
        
        /* ç»¿æ¤ */
        .plant {
            position: absolute;
            left: 20px;
            top: 20px;
            width: 40px;
            height: 60px;
        }
        
        .plant-pot {
            width: 40px;
            height: 20px;
            background: #8B4513;
            border-radius: 0 0 8px 8px;
            position: absolute;
            bottom: 0;
        }
        
        .plant-leaves {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .leaf {
            width: 15px;
            height: 25px;
            background: var(--plant);
            border-radius: 0 15px 15px 0;
            position: absolute;
            animation: sway 3s infinite ease-in-out;
        }
        
        .leaf:nth-child(1) {
            transform: rotate(-30deg);
            left: -5px;
        }
        
        .leaf:nth-child(2) {
            transform: rotate(30deg);
            right: -5px;
        }
        
        .leaf:nth-child(3) {
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        @keyframes sway {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(5deg); }
        }
        
        /* çŒ«çª */
        .cat-bed {
            position: absolute;
            right: 20px;
            top: 20px;
            width: 60px;
            height: 40px;
            background: var(--carpet);
            border-radius: 50% 50% 50% 50% / 40% 40% 60% 60%;
            box-shadow: inset 0 -5px 10px rgba(0,0,0,0.2);
        }
        
        /* åœ°æ¯¯ */
        .carpet {
            width: 80%;
            height: 15px;
            background: repeating-linear-gradient(
                90deg,
                var(--carpet),
                var(--carpet) 10px,
                #A02810 10px,
                #A02810 20px
            );
            margin: 80px auto 0;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* çŒ«å’ªå®¹å™¨ */
        .cat-container {
            width: 200px;
            height: 200px;
            margin: 40px auto;
            position: relative;
            cursor: pointer;
        }
        
        /* çŒ«å’ª */
        .cat {
            width: 120px;
            height: 120px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }
        
        .cat.happy {
            animation: bounce 0.6s ease;
        }
        
        .cat.sad {
            filter: grayscale(50%);
            animation: shake 0.5s ease;
        }
        
        .cat.hungry {
            animation: shake 0.5s ease infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translate(-50%, -50%); }
            50% { transform: translate(-50%, -70%); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(-5deg); }
            75% { transform: translate(-50%, -50%) rotate(5deg); }
        }
        
        /* çŒ«å’ªåƒä¸œè¥¿åŠ¨ç”» */
        .cat.eating {
            animation: eating 0.8s ease 3;
        }
        
        @keyframes eating {
            0%, 100% { transform: translate(-50%, -50%); }
            25% { transform: translate(-50%, -45%); }
            50% { transform: translate(-50%, -50%); }
            75% { transform: translate(-50%, -45%); }
        }
        
        /* çŒ«å’ªç©è€åŠ¨ç”» */
        .cat.playing {
            animation: playing 1s ease;
        }
        
        @keyframes playing {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -60%) rotate(-15deg); }
            50% { transform: translate(-50%, -50%) rotate(15deg); }
            75% { transform: translate(-50%, -60%) rotate(-10deg); }
            100% { transform: translate(-50%, -50%) rotate(0deg); }
        }
        
        /* é£Ÿç‰©/ç©å…·æ‰è½åŠ¨ç”» */
        .reward-item {
            position: absolute;
            font-size: 40px;
            pointer-events: none;
            animation: dropItem 1.5s ease-out forwards;
            z-index: 10;
        }
        
        @keyframes dropItem {
            0% {
                top: -50px;
                opacity: 1;
                transform: translateX(-50%) scale(0.5) rotate(0deg);
            }
            60% {
                top: 50%;
                transform: translateX(-50%) scale(1.2) rotate(180deg);
            }
            80% {
                top: 55%;
                transform: translateX(-50%) scale(0.9) rotate(360deg);
            }
            100% {
                top: 50%;
                opacity: 0;
                transform: translateX(-50%) scale(0.5) rotate(360deg);
            }
        }
        
        /* çŒ«å’ªèº«ä½“ - åƒç´ é£æ ¼ */
        .cat-body {
            width: 80px;
            height: 60px;
            background: var(--cat-color);
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 8px;
            box-shadow: 
                inset -10px 0 0 rgba(0,0,0,0.1),
                0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* çŒ«å’ªå¤´ */
        .cat-head {
            width: 70px;
            height: 60px;
            background: var(--cat-color);
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 50% 50% 40% 40%;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        /* çŒ«è€³æœµ */
        .cat-ear {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 25px solid var(--cat-color);
            position: absolute;
            top: -5px;
        }
        
        .cat-ear.left {
            left: 5px;
            transform: rotate(-15deg);
        }
        
        .cat-ear.right {
            right: 5px;
            transform: rotate(15deg);
        }
        
        /* çŒ«å’ªçœ¼ç› */
        .cat-eyes {
            display: flex;
            gap: 20px;
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .cat-eye {
            width: 8px;
            height: 12px;
            background: #2C3E50;
            border-radius: 50%;
            animation: blink 4s infinite;
        }
        
        @keyframes blink {
            0%, 96%, 100% { height: 12px; }
            98% { height: 2px; }
        }
        
        /* çŒ«é¼»å­å’Œå˜´ */
        .cat-nose {
            width: 8px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .cat-mouth {
            width: 20px;
            height: 10px;
            border: 2px solid #2C3E50;
            border-top: none;
            border-radius: 0 0 50% 50%;
            position: absolute;
            top: 43px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        /* çŒ«å°¾å·´ */
        .cat-tail {
            width: 40px;
            height: 15px;
            background: var(--cat-color);
            position: absolute;
            bottom: 25px;
            right: -35px;
            border-radius: 50%;
            transform-origin: left center;
            animation: tailWag 2s infinite ease-in-out;
        }
        
        @keyframes tailWag {
            0%, 100% { transform: rotate(-20deg); }
            50% { transform: rotate(20deg); }
        }
        
        /* çŒ«çˆªå­ */
        .cat-paws {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 40px;
        }
        
        .cat-paw {
            width: 15px;
            height: 20px;
            background: var(--cat-color);
            border-radius: 40% 40% 50% 50%;
            box-shadow: 0 3px 5px rgba(0,0,0,0.2);
        }
        
        /* çŠ¶æ€æ˜¾ç¤º */
        .status-bars {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 30px;
            padding: 0 20px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .status-label {
            font-family: 'Silkscreen', cursive;
            font-size: 14px;
            width: 60px;
            color: var(--text);
        }
        
        .status-bar-container {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-bar {
            flex: 1;
            height: 24px;
            background: #E0E0E0;
            border-radius: 12px;
            overflow: hidden;
            border: 3px solid var(--text);
            position: relative;
        }
        
        .status-value {
            font-family: 'Silkscreen', cursive;
            font-size: 14px;
            color: var(--text);
            min-width: 40px;
            text-align: right;
        }
        
        .status-fill {
            height: 100%;
            transition: width 0.5s ease, background 0.3s ease;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .status-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to bottom, rgba(255,255,255,0.4), transparent);
        }
        
        .status-fill.hunger { background: var(--accent); }
        .status-fill.happy { background: var(--primary); }
        .status-fill.health { background: var(--success); }
        
        /* å–æ°´æŒ‰é’® */
        .drink-button {
            width: 90%;
            margin: 30px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 20px;
            color: white;
            font-size: 24px;
            font-weight: bold;
            font-family: 'Silkscreen', cursive;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .drink-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }
        
        .drink-button:active {
            transform: translateY(0);
        }
        
        .drink-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .drink-button:hover::before {
            left: 100%;
        }
        
        /* å¥–åŠ±æç¤º */
        .reward-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 30px 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1000;
            text-align: center;
            border: 4px solid var(--primary);
            animation: popupAppear 0.5s ease forwards;
        }
        
        @keyframes popupAppear {
            to {
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        .reward-popup.hide {
            animation: popupDisappear 0.3s ease forwards;
        }
        
        @keyframes popupDisappear {
            to {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
        }
        
        .reward-icon {
            font-size: 60px;
            margin-bottom: 15px;
            animation: rewardBounce 0.6s ease infinite;
        }
        
        @keyframes rewardBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .reward-text {
            font-family: 'Silkscreen', cursive;
            font-size: 20px;
            color: var(--text);
            margin-bottom: 10px;
        }
        
        .reward-desc {
            font-size: 14px;
            color: #666;
        }
        
        /* è®°å½•é¡µé¢ */
        .record-page {
            padding: 20px;
            min-height: calc(100vh - 80px);
        }
        
        /* å‘¨ç»Ÿè®¡ */
        .week-stats {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .week-title {
            font-family: 'Silkscreen', cursive;
            font-size: 18px;
            color: var(--text);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .week-days {
            display: flex;
            justify-content: space-between;
            gap: 8px;
        }
        
        .day-item {
            flex: 1;
            text-align: center;
        }
        
        .day-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .day-check {
            width: 100%;
            height: 50px;
            border: 3px solid #E0E0E0;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s ease;
        }
        
        .day-check.completed {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }
        
        .day-check.today {
            border-color: var(--primary);
            border-width: 4px;
        }
        
        /* æ—¶é—´è½´ */
        .timeline-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .timeline-title {
            font-family: 'Silkscreen', cursive;
            font-size: 18px;
            color: var(--text);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .timeline {
            position: relative;
            padding-left: 40px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 25px;
            padding: 15px;
            background: var(--bg);
            border-radius: 12px;
            border: 2px solid #E0E0E0;
            transition: all 0.3s ease;
        }
        
        .timeline-item:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -33px;
            top: 20px;
            width: 16px;
            height: 16px;
            background: var(--primary);
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 0 0 3px var(--primary);
        }
        
        .timeline-time {
            font-family: 'Silkscreen', cursive;
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .timeline-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .timeline-icon {
            font-size: 24px;
        }
        
        .timeline-text {
            flex: 1;
        }
        
        .timeline-type {
            font-weight: 500;
            color: var(--text);
            margin-bottom: 3px;
        }
        
        .timeline-note {
            font-size: 13px;
            color: #666;
        }
        
        .timeline-edit {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 18px;
            padding: 5px;
            transition: transform 0.2s;
        }
        
        .timeline-edit:hover {
            transform: scale(1.2);
        }
        
        /* æ·»åŠ è®°å½•æŒ‰é’® */
        .add-record-btn {
            position: fixed;
            bottom: 80px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            font-size: 30px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
            transition: all 0.3s ease;
            z-index: 50;
        }
        
        .add-record-btn:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 12px 35px rgba(255, 107, 157, 0.5);
        }
        
        /* è®¾ç½®é¡µé¢ */
        .settings-page {
            padding: 20px;
            min-height: calc(100vh - 80px);
        }
        
        .settings-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .settings-title {
            font-family: 'Silkscreen', cursive;
            font-size: 18px;
            color: var(--text);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #E0E0E0;
        }
        
        .settings-item:last-child {
            border-bottom: none;
        }
        
        .settings-label {
            font-size: 15px;
            color: var(--text);
        }
        
        .settings-input {
            width: 120px;
            padding: 8px 12px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
            transition: border-color 0.3s;
        }
        
        .settings-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .settings-select {
            padding: 8px 12px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .settings-select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .settings-select:hover {
            border-color: var(--primary);
        }
        
        .settings-value {
            font-size: 16px;
            color: var(--primary);
            font-weight: 500;
        }
        
        /* å¼€å…³æŒ‰é’® */
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
            background: #E0E0E0;
            border-radius: 13px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .toggle-switch.active {
            background: var(--success);
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .toggle-switch.active::after {
            transform: translateX(24px);
        }
        
        /* æ°´é‡è®¡ç®—å¡ç‰‡ */
        .water-calc-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 8px 25px rgba(255, 107, 157, 0.3);
        }
        
        .water-amount {
            font-family: 'Silkscreen', cursive;
            font-size: 48px;
            margin: 15px 0;
        }
        
        .water-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* è§¦æ‘¸åé¦ˆ */
        .touch-feedback {
            position: absolute;
            pointer-events: none;
            border-radius: 50%;
            border: 2px solid var(--primary);
            animation: ripple 0.6s ease-out;
        }
        
        @keyframes ripple {
            from {
                width: 0;
                height: 0;
                opacity: 1;
            }
            to {
                width: 100px;
                height: 100px;
                opacity: 0;
            }
        }
        
        /* å“åº”å¼ */
        @media (max-width: 420px) {
            .app-container {
                width: 100%;
            }
            
            .week-days {
                gap: 4px;
            }
            
            .day-check {
                height: 45px;
            }
        }
        
        /* çŒ«å’ªæé—®æ ·å¼ */
        .cat-question-popup {
            padding: 30px 25px !important;
        }
        
        .question-answers {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .answer-btn {
            padding: 12px 20px;
            background: var(--bg);
            border: 2px solid var(--primary);
            border-radius: 12px;
            color: var(--text);
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .answer-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
        }
        
        .answer-btn:active {
            transform: translateY(0);
        }
        
        /* ç¡çœ é®ç½© */
        .sleep-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: 'Silkscreen', cursive;
            z-index: 20;
            backdrop-filter: blur(5px);
        }
        
        /* å†·å´æç¤º - ä¸­é—´ä½ç½® */
        .cooldown-tip-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 165, 2, 0.95);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-family: 'Noto Sans SC', sans-serif;
            box-shadow: 0 5px 20px rgba(255, 165, 2, 0.4);
            z-index: 15;
            animation: tipPulse 0.5s ease;
            pointer-events: none;
        }
        
        @keyframes tipPulse {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.05); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        /* çŒ«å’ªç¡è§‰çŠ¶æ€ */
        .cat.sleeping {
            filter: brightness(0.7);
        }
        
        .cat.sleeping .cat-eye {
            height: 2px !important;
            animation: none;
        }
        
        /* ç¼–è¾‘è®°å½•å¼¹çª— */
        .edit-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .edit-modal.show {
            display: flex;
        }
        
        .edit-modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .edit-modal-title {
            font-family: 'Silkscreen', cursive;
            font-size: 20px;
            color: var(--text);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .edit-form-group {
            margin-bottom: 15px;
        }
        
        .edit-form-label {
            display: block;
            font-size: 14px;
            color: var(--text);
            margin-bottom: 5px;
        }
        
        .edit-form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .edit-form-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .edit-form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .edit-form-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .edit-form-btn.cancel {
            background: #E0E0E0;
            color: var(--text);
        }
        
        .edit-form-btn.save {
            background: var(--primary);
            color: white;
        }
        
        .edit-form-btn.delete {
            background: #FF6B6B;
            color: white;
        }
        
        .edit-form-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <div class="top-nav">
            <button class="nav-btn active" data-page="home">ğŸ </button>
            <button class="nav-btn" data-page="record">ğŸ“Š</button>
            <button class="nav-btn" data-page="settings">âš™ï¸</button>
        </div>
        
        <!-- ä¸»é¡µé¢ -->
        <div class="page active" id="home-page">
            <div class="home-page">
                <!-- çª—æˆ· -->
                <div class="window">
                    <div class="clouds">
                        <div class="cloud"></div>
                        <div class="cloud"></div>
                    </div>
                </div>
                
                <!-- æˆ¿é—´å†…å®¹ -->
                <div class="room-content">
                    <!-- ç»¿æ¤ -->
                    <div class="plant">
                        <div class="plant-leaves">
                            <div class="leaf"></div>
                            <div class="leaf"></div>
                            <div class="leaf"></div>
                        </div>
                        <div class="plant-pot"></div>
                    </div>
                    
                    <!-- çŒ«çª -->
                    <div class="cat-bed"></div>
                    
                    <!-- åœ°æ¯¯ -->
                    <div class="carpet"></div>
                </div>
                
                <!-- çŒ«å’ª -->
                <div class="cat-container" id="catContainer">
                    <div class="cat" id="cat">
                        <div class="cat-head">
                            <div class="cat-ear left"></div>
                            <div class="cat-ear right"></div>
                            <div class="cat-eyes">
                                <div class="cat-eye"></div>
                                <div class="cat-eye"></div>
                            </div>
                            <div class="cat-nose"></div>
                            <div class="cat-mouth"></div>
                        </div>
                        <div class="cat-body">
                            <div class="cat-tail"></div>
                        </div>
                        <div class="cat-paws">
                            <div class="cat-paw"></div>
                            <div class="cat-paw"></div>
                        </div>
                    </div>
                    <!-- ç¡çœ é®ç½© -->
                    <div class="sleep-overlay" id="sleepOverlay" style="display: none;">
                        <div style="font-size: 40px; margin-bottom: 10px;">ğŸ˜´</div>
                        <div style="font-size: 16px;">çŒ«å’ªç¡ç€äº†...</div>
                        <div style="font-size: 13px; margin-top: 5px; opacity: 0.8;">æ˜æ—©6ç‚¹è§~</div>
                    </div>
                </div>
                
                <!-- å†·å´æç¤º - ç§»åˆ°ä¸­é—´ -->
                <div id="cooldownTip" class="cooldown-tip-center" style="display: none;">
                    âš ï¸ å–å¤ªå¿«å•¦ï¼Œæ…¢æ…¢æ¥~
                </div>
                
                <!-- çŠ¶æ€æ¡ -->
                <div class="status-bars">
                    <div class="status-item">
                        <div class="status-label">é¥¥é¥¿</div>
                        <div class="status-bar-container">
                            <div class="status-bar">
                                <div class="status-fill hunger" id="hungerBar" style="width: 70%"></div>
                            </div>
                            <div class="status-value" id="hungerValue">70</div>
                        </div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">å¿«ä¹</div>
                        <div class="status-bar-container">
                            <div class="status-bar">
                                <div class="status-fill happy" id="happyBar" style="width: 80%"></div>
                            </div>
                            <div class="status-value" id="happyValue">80</div>
                        </div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">å¥åº·</div>
                        <div class="status-bar-container">
                            <div class="status-bar">
                                <div class="status-fill health" id="healthBar" style="width: 90%"></div>
                            </div>
                            <div class="status-value" id="healthValue">90</div>
                        </div>
                    </div>
                </div>
                
                <!-- è¿›åº¦æ˜¾ç¤º -->
                <div style="text-align: center; margin: 20px 0; font-family: 'Silkscreen', cursive;">
                    <div style="font-size: 16px; color: var(--text); margin-bottom: 8px;">
                        ä»Šæ—¥è¿›åº¦
                    </div>
                    <div style="font-size: 32px; color: var(--primary);">
                        <span id="todaySipsCount">0</span> / <span id="targetSipsCount">18</span> æ¬¡
                    </div>
                    <div style="font-size: 14px; color: #666; margin-top: 5px;">
                        <span id="todayMlCount">0</span> / <span id="targetMlCount">1800</span> ml
                    </div>
                </div>
                
                <!-- å–æ°´æŒ‰é’® -->
                <button class="drink-button" id="drinkBtn">
                    ğŸ’§ å–ä¸€å£æ°´
                </button>
            </div>
        </div>
        
        <!-- è®°å½•é¡µé¢ -->
        <div class="page" id="record-page">
            <div class="record-page">
                <!-- å‘¨ç»Ÿè®¡ -->
                <div class="week-stats">
                    <div class="week-title">ğŸ“… æœ¬å‘¨å®Œæˆæƒ…å†µ</div>
                    <div class="week-days">
                        <div class="day-item">
                            <div class="day-label">å‘¨ä¸€</div>
                            <div class="day-check completed">âœ“</div>
                        </div>
                        <div class="day-item">
                            <div class="day-label">å‘¨äºŒ</div>
                            <div class="day-check completed">âœ“</div>
                        </div>
                        <div class="day-item">
                            <div class="day-label">å‘¨ä¸‰</div>
                            <div class="day-check today completed">âœ“</div>
                        </div>
                        <div class="day-item">
                            <div class="day-label">å‘¨å››</div>
                            <div class="day-check"></div>
                        </div>
                        <div class="day-item">
                            <div class="day-label">å‘¨äº”</div>
                            <div class="day-check"></div>
                        </div>
                        <div class="day-item">
                            <div class="day-label">å‘¨å…­</div>
                            <div class="day-check"></div>
                        </div>
                        <div class="day-item">
                            <div class="day-label">å‘¨æ—¥</div>
                            <div class="day-check"></div>
                        </div>
                    </div>
                </div>
                
                <!-- æ—¶é—´è½´ -->
                <div class="timeline-section">
                    <div class="timeline-title">â° ä»Šæ—¥é¥®æ°´è®°å½•</div>
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-time">08:30</div>
                            <div class="timeline-content">
                                <div class="timeline-icon">â˜€ï¸</div>
                                <div class="timeline-text">
                                    <div class="timeline-type">æ™¨èµ·ç¬¬ä¸€æ¯æ°´</div>
                                    <div class="timeline-note">æ¸©å¼€æ°´ Â· 250ml</div>
                                </div>
                                <button class="timeline-edit">âœï¸</button>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-time">10:15</div>
                            <div class="timeline-content">
                                <div class="timeline-icon">ğŸ’¼</div>
                                <div class="timeline-text">
                                    <div class="timeline-type">å·¥ä½œé—´éš™è¡¥æ°´</div>
                                    <div class="timeline-note">æŸ æª¬æ°´ Â· 200ml</div>
                                </div>
                                <button class="timeline-edit">âœï¸</button>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-time">14:20</div>
                            <div class="timeline-content">
                                <div class="timeline-icon">â˜•</div>
                                <div class="timeline-text">
                                    <div class="timeline-type">åˆåæç¥</div>
                                    <div class="timeline-note">ç¾å¼å’–å•¡ Â· 300ml</div>
                                </div>
                                <button class="timeline-edit">âœï¸</button>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-time">17:45</div>
                            <div class="timeline-content">
                                <div class="timeline-icon">ğŸŒ¸</div>
                                <div class="timeline-text">
                                    <div class="timeline-type">ä¸‹åˆèŒ¶æ—¶å…‰</div>
                                    <div class="timeline-note">èŠ±èŒ¶ Â· 250ml</div>
                                </div>
                                <button class="timeline-edit">âœï¸</button>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-time">21:00</div>
                            <div class="timeline-content">
                                <div class="timeline-icon">ğŸŒ™</div>
                                <div class="timeline-text">
                                    <div class="timeline-type">ç¡å‰ä¸€æ¯</div>
                                    <div class="timeline-note">çƒ­ç‰›å¥¶ Â· 200ml</div>
                                </div>
                                <button class="timeline-edit">âœï¸</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æ·»åŠ è®°å½•æŒ‰é’® -->
                <button class="add-record-btn" id="addRecordBtn">+</button>
            </div>
        </div>
        
        <!-- ç¼–è¾‘/æ·»åŠ è®°å½•å¼¹çª— -->
        <div class="edit-modal" id="editModal">
            <div class="edit-modal-content">
                <div class="edit-modal-title" id="modalTitle">æ·»åŠ è®°å½•</div>
                <form id="editForm">
                    <div class="edit-form-group">
                        <label class="edit-form-label">æ—¶é—´</label>
                        <input type="time" class="edit-form-input" id="editTime" required>
                    </div>
                    <div class="edit-form-group">
                        <label class="edit-form-label">ç±»å‹</label>
                        <input type="text" class="edit-form-input" id="editType" placeholder="ä¾‹å¦‚ï¼šæ™¨èµ·ç¬¬ä¸€æ¯æ°´" required>
                    </div>
                    <div class="edit-form-group">
                        <label class="edit-form-label">å†…å®¹</label>
                        <input type="text" class="edit-form-input" id="editContent" placeholder="ä¾‹å¦‚ï¼šæ¸©å¼€æ°´ Â· 250ml" required>
                    </div>
                    <div class="edit-form-group">
                        <label class="edit-form-label">å›¾æ ‡</label>
                        <select class="edit-form-input" id="editIcon">
                            <option value="â˜€ï¸">â˜€ï¸ æ—©æ™¨</option>
                            <option value="ğŸ’¼">ğŸ’¼ å·¥ä½œ</option>
                            <option value="â˜•">â˜• å’–å•¡/èŒ¶</option>
                            <option value="ğŸŒ¸">ğŸŒ¸ èŠ±èŒ¶</option>
                            <option value="ğŸŒ™">ğŸŒ™ æ™šä¸Š</option>
                            <option value="ğŸ’§">ğŸ’§ çº¯æ°´</option>
                            <option value="ğŸ¥¤">ğŸ¥¤ é¥®æ–™</option>
                        </select>
                    </div>
                    <div class="edit-form-buttons">
                        <button type="button" class="edit-form-btn cancel" id="cancelBtn">å–æ¶ˆ</button>
                        <button type="button" class="edit-form-btn delete" id="deleteBtn" style="display: none;">åˆ é™¤</button>
                        <button type="submit" class="edit-form-btn save">ä¿å­˜</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- è®¾ç½®é¡µé¢ -->
        <div class="page" id="settings-page">
            <div class="settings-page">
                <!-- åŸºæœ¬ä¿¡æ¯ -->
                <div class="settings-section">
                    <div class="settings-title">ğŸ‘¤ åŸºæœ¬ä¿¡æ¯</div>
                    <div class="settings-item">
                        <div class="settings-label">çŒ«å’ªåå­—</div>
                        <input type="text" class="settings-input" value="å°å–µ" id="catName">
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">èº«é«˜ (cm)</div>
                        <input type="number" class="settings-input" value="170" id="userHeight">
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">ä½“é‡ (kg)</div>
                        <input type="number" class="settings-input" value="60" id="userWeight">
                    </div>
                </div>
                
                <!-- æ¯æ—¥ç›®æ ‡ -->
                <div class="settings-section">
                    <div class="settings-title">ğŸ¯ æ¯æ—¥ç›®æ ‡</div>
                    <div class="water-calc-card">
                        <div class="water-label">å»ºè®®æ¯æ—¥é¥®æ°´é‡</div>
                        <div class="water-amount" id="targetWater">2000</div>
                        <div class="water-label">æ¯«å‡ (ml)</div>
                    </div>
                    <div style="margin-top: 15px; font-size: 13px; color: #666; text-align: center;">
                        ğŸ’¡ æ ¹æ®ä½“é‡è®¡ç®—ï¼š30-35ml/kg
                    </div>
                </div>
                
                <!-- å–æ°´ä¹ æƒ¯ -->
                <div class="settings-section">
                    <div class="settings-title">ğŸ’§ å–æ°´ä¹ æƒ¯</div>
                    <div class="settings-item">
                        <div class="settings-label">æ¯æ¬¡å–æ°´é‡</div>
                        <select class="settings-select" id="sipsSize">
                            <option value="75">å°å£ï¼ˆ75mlï¼‰</option>
                            <option value="100" selected>æ­£å¸¸ï¼ˆ100mlï¼‰</option>
                            <option value="150">å¤§å£ï¼ˆ150mlï¼‰</option>
                        </select>
                    </div>
                    <div class="settings-item" style="border: none; padding-top: 5px;">
                        <div style="font-size: 13px; color: #666; line-height: 1.5;">
                            ğŸ’¡ å°å£ï¼šçº¦3å£æ°´ | æ­£å¸¸ï¼šçº¦4å£æ°´ | å¤§å£ï¼šçº¦6å£æ°´
                        </div>
                    </div>
                </div>
                
                <!-- æé†’è®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-title">ğŸ”” æé†’è®¾ç½®</div>
                    <div class="settings-item">
                        <div class="settings-label">å¼€å¯æé†’</div>
                        <div class="toggle-switch active" id="notificationToggle"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">æé†’é—´éš”</div>
                        <div class="settings-value">60 åˆ†é’Ÿ</div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">æé†’éŸ³æ•ˆ</div>
                        <div class="toggle-switch active" id="soundToggle"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">èƒŒæ™¯éŸ³ä¹</div>
                        <div class="toggle-switch" id="musicToggle"></div>
                    </div>
                </div>
                
                <!-- å…¶ä»–è®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-title">ğŸ¨ å…¶ä»–è®¾ç½®</div>
                    <div class="settings-item">
                        <div class="settings-label">æ·±è‰²æ¨¡å¼</div>
                        <div class="toggle-switch" id="darkModeToggle"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">åŠ¨ç”»æ•ˆæœ</div>
                        <div class="toggle-switch active" id="animationToggle"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">ç‰ˆæœ¬å·</div>
                        <div class="settings-value">v1.0.0</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // é€šçŸ¥åŠŸèƒ½
        let notificationPermission = 'default';
        
        // è¯·æ±‚é€šçŸ¥æƒé™
        async function requestNotificationPermission() {
            if ('Notification' in window) {
                notificationPermission = await Notification.requestPermission();
                console.log('é€šçŸ¥æƒé™:', notificationPermission);
                
                if (notificationPermission === 'granted') {
                    console.log('âœ… é€šçŸ¥æƒé™å·²è·å–');
                } else {
                    console.log('âŒ ç”¨æˆ·æ‹’ç»äº†é€šçŸ¥æƒé™');
                }
            } else {
                console.log('âŒ æµè§ˆå™¨ä¸æ”¯æŒé€šçŸ¥');
            }
        }
        
        // å‘é€é€šçŸ¥
        function sendNotification(title, body, icon = 'ğŸ’§') {
            if (notificationPermission === 'granted') {
                new Notification(title, {
                    body: body,
                    icon: icon,
                    badge: 'ğŸ±',
                    tag: 'water-reminder',
                    requireInteraction: false,
                    silent: false
                });
            }
        }
        
        // è®¾ç½®å®šæ—¶æé†’
        let reminderInterval = null;
        
        function startReminder(intervalMinutes = 60) {
            // æ¸…é™¤æ—§çš„å®šæ—¶å™¨
            if (reminderInterval) {
                clearInterval(reminderInterval);
            }
            
            // è®¾ç½®æ–°çš„å®šæ—¶å™¨
            reminderInterval = setInterval(() => {
                // åªåœ¨ç™½å¤©æé†’ï¼ˆ6:00-22:00ï¼‰
                const hour = new Date().getHours();
                if (hour >= 6 && hour < 22) {
                    const messages = [
                        'è¯¥å–æ°´å•¦å–µ~',
                        'è®°å¾—è¡¥å……æ°´åˆ†å“¦',
                        'å–µ~ ä¼‘æ¯ä¸€ä¸‹å–ç‚¹æ°´å§',
                        'å¥½ä¹…æ²¡å–æ°´äº†å‘¢',
                        'æ¥å–ä¸€å£æ°´å§~'
                    ];
                    const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                    sendNotification('ğŸ± å–µå–µæé†’', randomMessage);
                }
            }, intervalMinutes * 60 * 1000);
            
            console.log(`â° æé†’å·²å¼€å¯ï¼šæ¯${intervalMinutes}åˆ†é’Ÿæé†’ä¸€æ¬¡`);
        }
        
        function stopReminder() {
            if (reminderInterval) {
                clearInterval(reminderInterval);
                reminderInterval = null;
                console.log('â° æé†’å·²å…³é—­');
            }
        }
        
        // çŠ¶æ€ç®¡ç†
        const appState = {
            hunger: 70,
            happy: 80,
            health: 90,
            lastDrinkTime: Date.now(),
            lastDecayTime: Date.now(), // ä¸Šæ¬¡æ•°å€¼è¡°å‡çš„æ—¶é—´
            catName: 'å°å–µ',
            drinkCount: 0,
            todaySips: 0, // ä»Šæ—¥å·²å–æ¬¡æ•°
            targetSips: 18, // ç›®æ ‡æ¬¡æ•°ï¼ˆé»˜è®¤100ml/æ¬¡ï¼‰
            mlPerSip: 100, // æ¯æ¬¡çš„æ¯«å‡æ•°ï¼ˆå¯é€‰75/100/150ï¼‰
            recentDrinks: [], // æœ€è¿‘çš„å–æ°´æ—¶é—´è®°å½•
            cooldownMultiplier: 1.0, // å†·å´å€æ•°
            goalCompleted: false, // ä»Šæ—¥ç›®æ ‡æ˜¯å¦å®Œæˆ
            isSleeping: false, // æ˜¯å¦åœ¨ç¡è§‰
            waterRecords: [ // ä»Šæ—¥é¥®æ°´è®°å½•
                { id: 1, time: '08:30', type: 'æ™¨èµ·ç¬¬ä¸€æ¯æ°´', content: 'æ¸©å¼€æ°´ Â· 250ml', icon: 'â˜€ï¸' },
                { id: 2, time: '10:15', type: 'å·¥ä½œé—´éš™è¡¥æ°´', content: 'æŸ æª¬æ°´ Â· 200ml', icon: 'ğŸ’¼' },
                { id: 3, time: '14:20', type: 'åˆåæç¥', content: 'ç¾å¼å’–å•¡ Â· 300ml', icon: 'â˜•' },
                { id: 4, time: '17:45', type: 'ä¸‹åˆèŒ¶æ—¶å…‰', content: 'èŠ±èŒ¶ Â· 250ml', icon: 'ğŸŒ¸' },
                { id: 5, time: '21:00', type: 'ç¡å‰ä¸€æ¯', content: 'çƒ­ç‰›å¥¶ Â· 200ml', icon: 'ğŸŒ™' }
            ],
            currentEditId: null, // å½“å‰ç¼–è¾‘çš„è®°å½•ID
            settings: {
                height: 170,
                weight: 60,
                sipsSize: 100, // æ¯æ¬¡å–æ°´é‡
                notifications: true,
                sound: true,
                music: false,
                darkMode: false,
                animation: true
            }
        };
        
        // çŒ«å’ªæé—®åº“ï¼ˆæ ¹æ®æ—¶é—´å’Œæƒ…å¢ƒï¼‰
        const catQuestions = {
            morning: [ // æ—©ä¸Š 6:00-11:00
                { q: "æ˜¨æ™šç¡å¾—å¥½å—å–µ~ï¼Ÿ", a: ["ç¡å¾—è¶…å¥½", "è¿˜è¡Œå§", "æœ‰ç‚¹å¤±çœ "] },
                { q: "ä»Šå¤©åƒæ—©é¤äº†å—ï¼Ÿ", a: ["åƒäº†", "è¿˜æ²¡åƒ", "ä¸æƒ³åƒ"] },
                { q: "èµ·åºŠçš„æ—¶å€™æœ‰ä¼¸æ‡’è…°å—å–µï¼Ÿ", a: ["æœ‰å•Š", "å¿˜äº†", "è¿˜æ²¡èµ·æ¥å‘¢"] },
                { q: "ä»Šå¤©å¤©æ°”çœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ", a: ["å¾ˆå¥½", "ä¸€èˆ¬èˆ¬", "ä¸å¤ªå¥½"] }
            ],
            noon: [ // ä¸­åˆ 11:00-14:00
                { q: "åˆé¥­åƒä»€ä¹ˆå¥½åƒçš„äº†å—ï¼Ÿ", a: ["å¾ˆå¥½åƒ", "ä¸€èˆ¬èˆ¬", "è¿˜æ²¡åƒ"] },
                { q: "æœ‰æ²¡æœ‰åˆä¼‘ä¸€ä¸‹ï¼Ÿ", a: ["ç¡äº†", "æ²¡æ—¶é—´", "ä¸æƒ³ç¡"] },
                { q: "å·¥ä½œç´¯ä¸ç´¯å‘€ï¼Ÿ", a: ["æœ‰ç‚¹ç´¯", "è¿˜å¥½", "ä¸ç´¯"] }
            ],
            afternoon: [ // ä¸‹åˆ 14:00-18:00
                { q: "ä¸‹åˆå›°ä¸å›°å‘€å–µï¼Ÿ", a: ["æœ‰ç‚¹å›°", "è¿˜å¥½", "å¾ˆç²¾ç¥"] },
                { q: "ä»Šå¤©å·¥ä½œ/å­¦ä¹ é¡ºåˆ©å—ï¼Ÿ", a: ["å¾ˆé¡ºåˆ©", "è¿˜è¡Œ", "æœ‰ç‚¹éš¾"] },
                { q: "éœ€è¦æˆ‘é™ªä½ å—å–µ~ï¼Ÿ", a: ["éœ€è¦", "ä¸ç”¨", "ç­‰ä¸€ä¸‹"] },
                { q: "æƒ³ä¸æƒ³å‡ºå»èµ°èµ°ï¼Ÿ", a: ["æƒ³", "ä¸æƒ³", "ç­‰ä¼šå„¿"] }
            ],
            evening: [ // æ™šä¸Š 18:00-22:00
                { q: "ä»Šå¤©ç´¯ä¸ç´¯å‘€ï¼Ÿ", a: ["å¥½ç´¯", "è¿˜å¥½", "ä¸ç´¯"] },
                { q: "æ™šé¥­å¥½åƒå—ï¼Ÿ", a: ["å¾ˆå¥½åƒ", "ä¸€èˆ¬", "è¿˜æ²¡åƒ"] },
                { q: "æ˜å¤©æœ‰ä»€ä¹ˆè®¡åˆ’å—ï¼Ÿ", a: ["æœ‰", "æ²¡æœ‰", "ä¸çŸ¥é“"] },
                { q: "å‡†å¤‡ä»€ä¹ˆæ—¶å€™ç¡è§‰ï¼Ÿ", a: ["æ—©ç‚¹ç¡", "å†ç©ä¼š", "ä¸çŸ¥é“"] }
            ],
            night: [ // æ·±å¤œ 22:00-6:00
                { q: "æ€ä¹ˆè¿˜ä¸ç¡è§‰å–µ~ï¼Ÿ", a: ["é©¬ä¸Šç¡", "ç¡ä¸ç€", "è¿˜æœ‰äº‹"] },
                { q: "è¦æˆ‘é™ªä½ ä¸€èµ·ç¡å—ï¼Ÿ", a: ["è¦", "ä¸ç”¨", "å¥½å‘€"] },
                { q: "æ˜å¤©è¦æ—©èµ·å—ï¼Ÿ", a: ["è¦", "ä¸ç”¨", "ä¸çŸ¥é“"] }
            ],
            weather: {
                rainy: [
                    { q: "å¤–é¢åœ¨ä¸‹é›¨è¯¶ï¼Œæœ‰å¸¦ä¼å—ï¼Ÿ", a: ["å¸¦äº†", "æ²¡å¸¦", "åœ¨å®¶é‡Œ"] },
                    { q: "ä¸‹é›¨å¤©å–çƒ­æ°´ä¼šæ›´èˆ’æœå“¦~", a: ["å—¯å—¯", "æˆ‘å–çš„å‡‰çš„", "å¥½çš„"] }
                ],
                sunny: [
                    { q: "ä»Šå¤©å¤©æ°”çœŸå¥½å‘€ï¼", a: ["æ˜¯å•Š", "è¿˜è¡Œå§", "æœ‰ç‚¹çƒ­"] }
                ]
            },
            general: [ // é€šç”¨é—®é¢˜
                { q: "è¿™æ°´æ˜¯æ¸©çš„è¿˜æ˜¯å‡‰çš„å‘€ï¼Ÿ", a: ["å‡‰çš„", "æ¸©çš„", "çƒ­çš„"] },
                { q: "æ¯å­æ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼Ÿ", a: ["ç™½è‰²", "é€æ˜", "å…¶ä»–é¢œè‰²"] },
                { q: "å–å®Œæ„Ÿè§‰æ€ä¹ˆæ ·ï¼Ÿ", a: ["å¾ˆèˆ’æœ", "è¿˜å¥½", "æœ‰ç‚¹æ¸´"] },
                { q: "åŠ äº†ä»€ä¹ˆå—ï¼Ÿ", a: ["ä»€ä¹ˆéƒ½æ²¡åŠ ", "åŠ äº†æŸ æª¬", "åŠ äº†å…¶ä»–"] },
                { q: "ä½ çš„æ¯å­å¤§æ¦‚å¤šå¤§å‘€ï¼Ÿ", a: ["å¾ˆå¤§", "ä¸­ç­‰", "å°å°çš„"] },
                { q: "ç°åœ¨å¿ƒæƒ…æ€ä¹ˆæ ·å–µ~ï¼Ÿ", a: ["å¾ˆå¥½", "ä¸€èˆ¬", "æœ‰ç‚¹ç´¯"] }
            ]
        };
        
        // å­˜å‚¨ç”¨æˆ·å›ç­”å†å²
        const conversationHistory = [];
        
        // çŒ«å’ªçš„æ¸©æŸ”æé†’ï¼ˆå¶å°”å¹½é»˜ï¼‰
        const gentleReminders = [
            "æ°´å¥½åƒæ²¡å–åˆ°å–µ~",
            "åˆ«ç€æ€¥ï¼Œæ…¢æ…¢æ¥å–µ",
            "ä¼‘æ¯ä¸€ä¸‹å†å–å§",
            "æ˜¯åœ¨è¿åŠ¨å—...",
            "æ…¢ä¸€ç‚¹ä¼šæ›´èˆ’æœå“¦",
            "å–µ~ ä½ è¯¥ä¸ä¼šåœ¨åˆ·ä»»åŠ¡å§",
            "å–æ°´è¦æ…¢æ…¢å–æ‰å¥åº·å‘¢",
            "åˆ°åº•æœ‰æ²¡æœ‰åœ¨å–å•¦",
            "å—¯... æ„Ÿè§‰ä½ æœ‰ç‚¹å¿ƒæ€¥äº†",
            "çŒ«çŒ«æ€€ç–‘ä¸­..."
        ];
        
        // é¡µé¢åˆ‡æ¢
        const navBtns = document.querySelectorAll('.nav-btn');
        const pages = document.querySelectorAll('.page');
        
        navBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetPage = btn.dataset.page;
                
                navBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                pages.forEach(p => p.classList.remove('active'));
                document.getElementById(`${targetPage}-page`).classList.add('active');
            });
        });
        
        // çŒ«å’ªäº¤äº’
        const cat = document.getElementById('cat');
        const catContainer = document.getElementById('catContainer');
        let isPressing = false;
        let pressTimer = null;
        
        catContainer.addEventListener('mousedown', startPress);
        catContainer.addEventListener('touchstart', startPress);
        catContainer.addEventListener('mouseup', endPress);
        catContainer.addEventListener('touchend', endPress);
        catContainer.addEventListener('mouseleave', endPress);
        
        function startPress(e) {
            isPressing = true;
            pressTimer = setTimeout(() => {
                if (isPressing) {
                    // é•¿æŒ‰ç¿»è‚šçš®
                    cat.style.transform = 'translate(-50%, -50%) rotate(180deg)';
                    cat.classList.add('happy');
                    appState.happy = Math.min(100, appState.happy + 5);
                    updateStatusBars();
                    
                    setTimeout(() => {
                        cat.style.transform = 'translate(-50%, -50%) rotate(0deg)';
                    }, 2000);
                }
            }, 800);
            
            // è§¦æ‘¸åé¦ˆ
            createRipple(e);
        }
        
        function endPress() {
            isPressing = false;
            clearTimeout(pressTimer);
        }
        
        function createRipple(e) {
            const ripple = document.createElement('div');
            ripple.className = 'touch-feedback';
            const rect = catContainer.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            catContainer.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 600);
        }
        
        // å–æ°´åŠŸèƒ½
        const drinkBtn = document.getElementById('drinkBtn');
        const hungerBar = document.getElementById('hungerBar');
        const happyBar = document.getElementById('happyBar');
        const healthBar = document.getElementById('healthBar');
        const hungerValue = document.getElementById('hungerValue');
        const happyValue = document.getElementById('happyValue');
        const healthValue = document.getElementById('healthValue');
        const cooldownTip = document.getElementById('cooldownTip');
        const sleepOverlay = document.getElementById('sleepOverlay');
        const todaySipsCount = document.getElementById('todaySipsCount');
        const targetSipsCount = document.getElementById('targetSipsCount');
        const todayMlCount = document.getElementById('todayMlCount');
        const targetMlCount = document.getElementById('targetMlCount');
        
        drinkBtn.addEventListener('click', () => {
            // æ£€æŸ¥æ˜¯å¦åœ¨ç¡è§‰
            if (appState.isSleeping) {
                return;
            }
            drinkWater();
        });
        
        // æ£€æŸ¥ç¡çœ çŠ¶æ€
        function checkSleepStatus() {
            const hour = new Date().getHours();
            const shouldSleep = hour >= 22 || hour < 6;
            
            if (shouldSleep && !appState.isSleeping) {
                // è¿›å…¥ç¡çœ 
                appState.isSleeping = true;
                cat.classList.add('sleeping');
                sleepOverlay.style.display = 'flex';
                drinkBtn.disabled = true;
                drinkBtn.style.opacity = '0.5';
                drinkBtn.style.cursor = 'not-allowed';
            } else if (!shouldSleep && appState.isSleeping) {
                // é†’æ¥ï¼Œé‡ç½®æ¯æ—¥ä»»åŠ¡
                appState.isSleeping = false;
                cat.classList.remove('sleeping');
                sleepOverlay.style.display = 'none';
                drinkBtn.disabled = false;
                drinkBtn.style.opacity = '1';
                drinkBtn.style.cursor = 'pointer';
                
                // é‡ç½®æ¯æ—¥æ•°æ®
                appState.todaySips = 0;
                appState.goalCompleted = false;
                drinkBtn.innerHTML = 'ğŸ’§ å–ä¸€å£æ°´';
                drinkBtn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                updateProgress();
            }
        }
        
        function calculateCooldownMultiplier() {
            const now = Date.now();
            const recentWindow = 2 * 60 * 1000; // 2åˆ†é’Ÿçª—å£
            
            // æ¸…ç†2åˆ†é’Ÿå‰çš„è®°å½•
            appState.recentDrinks = appState.recentDrinks.filter(time => now - time < recentWindow);
            
            // æ ¹æ®æœ€è¿‘å–æ°´æ¬¡æ•°è®¡ç®—å†·å´å€æ•°
            const recentCount = appState.recentDrinks.length;
            
            // å‰3å£æ˜¯æ­£å¸¸çš„ï¼Œä¸è§¦å‘æƒ©ç½š
            if (recentCount <= 3) {
                appState.cooldownMultiplier = 1.0;
                cooldownTip.style.display = 'none';
            } else if (recentCount === 4) {
                // ç¬¬4å£å¼€å§‹è½»å¾®é™ä½
                appState.cooldownMultiplier = 0.7;
                showCooldownTip('æ…¢ä¸€ç‚¹ä¼šæ›´å¥½å“¦~');
            } else if (recentCount === 5) {
                // ç¬¬5å£é€‚åº¦é™ä½
                appState.cooldownMultiplier = 0.5;
                showCooldownTip('å–å¤ªå¿«å•¦ï¼Œä¼‘æ¯ä¸€ä¸‹~');
            } else if (recentCount >= 6) {
                // ç¬¬6å£åŠä»¥ä¸Šä¸¥é‡é™ä½
                appState.cooldownMultiplier = 0.2;
                const reminder = gentleReminders[Math.floor(Math.random() * gentleReminders.length)];
                showCooldownTip(reminder);
            }
            
            return appState.cooldownMultiplier;
        }
        
        function showCooldownTip(message) {
            cooldownTip.textContent = message;
            cooldownTip.style.display = 'block';
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                cooldownTip.style.display = 'none';
            }, 3000);
        }
        
        // å®šæœŸæ£€æŸ¥å†·å´æ¢å¤ï¼ˆæ¯10ç§’æ£€æŸ¥ä¸€æ¬¡ï¼‰
        setInterval(() => {
            const now = Date.now();
            const recentWindow = 2 * 60 * 1000; // 2åˆ†é’Ÿçª—å£
            appState.recentDrinks = appState.recentDrinks.filter(time => now - time < recentWindow);
            
            const recentCount = appState.recentDrinks.length;
            
            // å¦‚æœ2åˆ†é’Ÿå†…å–æ°´æ¬¡æ•°<=3æ¬¡ï¼Œæ¢å¤æ­£å¸¸
            if (recentCount <= 3) {
                appState.cooldownMultiplier = 1.0;
                cooldownTip.style.display = 'none';
            }
        }, 10000); // æ¯10ç§’æ£€æŸ¥ä¸€æ¬¡
        
        function getTimeBasedQuestions() {
            const hour = new Date().getHours();
            
            if (hour >= 6 && hour < 11) return catQuestions.morning;
            if (hour >= 11 && hour < 14) return catQuestions.noon;
            if (hour >= 14 && hour < 18) return catQuestions.afternoon;
            if (hour >= 18 && hour < 22) return catQuestions.evening;
            return catQuestions.night;
        }
        
        function drinkWater() {
            const now = Date.now();
            appState.recentDrinks.push(now);
            appState.drinkCount++;
            appState.todaySips++;
            appState.lastDrinkTime = now;
            
            // è®¡ç®—å†·å´å€æ•°
            const multiplier = calculateCooldownMultiplier();
            
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            updateProgress();
            
            // éšæœºå¥–åŠ±
            const rewards = [
                { type: 'çŒ«ç²®', icon: 'ğŸ–', chance: 0.6, effect: 'hunger', value: 15, anim: 'eating' },
                { type: 'é›¶é£Ÿ', icon: 'ğŸŸ', chance: 0.25, effect: 'happy', value: 20, anim: 'eating' },
                { type: 'ç©å…·', icon: 'ğŸ¾', chance: 0.15, effect: 'play', value: 0, anim: 'playing' }
            ];
            
            const random = Math.random();
            let cumulative = 0;
            let reward = rewards[0];
            
            for (const r of rewards) {
                cumulative += r.chance;
                if (random <= cumulative) {
                    reward = r;
                    break;
                }
            }
            
            // æ˜¾ç¤ºæ‰è½çš„é£Ÿç‰©/ç©å…·
            showRewardDrop(reward.icon);
            
            // åº”ç”¨å¥–åŠ±ï¼ˆå—å†·å´å€æ•°å½±å“ï¼‰
            const actualValue = Math.floor(reward.value * multiplier);
            
            // çŒ«å’ªåŠ¨ç”»
            cat.classList.add(reward.anim);
            
            if (reward.effect === 'hunger') {
                appState.hunger = Math.min(100, appState.hunger + actualValue);
                cat.classList.remove('hungry', 'sad');
            } else if (reward.effect === 'happy') {
                appState.happy = Math.min(100, appState.happy + actualValue);
            }
            
            appState.health = Math.min(100, appState.health + Math.floor(5 * multiplier));
            
            updateStatusBars();
            
            // éšæœºè§¦å‘çŒ«å’ªæé—®ï¼ˆ30%æ¦‚ç‡ï¼Œä¸”å†·å´å€æ•°>0.5æ‰ä¼šé—®ï¼‰
            if (Math.random() < 0.3 && multiplier > 0.5) {
                setTimeout(() => {
                    showCatQuestion();
                }, 1500);
            }
            
            setTimeout(() => {
                cat.classList.remove(reward.anim);
            }, reward.anim === 'eating' ? 2400 : 1000);
        }
        
        function showRewardDrop(icon) {
            const rewardItem = document.createElement('div');
            rewardItem.className = 'reward-item';
            rewardItem.textContent = icon;
            rewardItem.style.left = '50%';
            catContainer.appendChild(rewardItem);
            
            setTimeout(() => {
                rewardItem.remove();
            }, 1500);
        }
        
        function updateProgress() {
            const targetSips = appState.targetSips;
            const targetMl = targetSips * appState.mlPerSip;
            const todayMl = appState.todaySips * appState.mlPerSip;
            
            todaySipsCount.textContent = appState.todaySips;
            targetSipsCount.textContent = targetSips;
            todayMlCount.textContent = todayMl;
            targetMlCount.textContent = targetMl;
            
            // å¦‚æœå®Œæˆç›®æ ‡
            if (appState.todaySips >= targetSips && !appState.goalCompleted) {
                appState.goalCompleted = true;
                drinkBtn.innerHTML = 'âœ¨ ä»Šæ—¥ç›®æ ‡å·²å®Œæˆï¼';
                drinkBtn.style.background = 'linear-gradient(135deg, #6BCB77 0%, #4D9559 100%)';
                
                // æ˜¾ç¤ºå®Œæˆåº†ç¥
                showGoalComplete();
            }
        }
        
        function showGoalComplete() {
            const popup = document.createElement('div');
            popup.className = 'reward-popup';
            popup.innerHTML = `
                <div style="font-size: 60px; margin-bottom: 15px;">ğŸ‰</div>
                <div style="font-size: 20px; color: var(--success); font-weight: bold; margin-bottom: 10px;">
                    ä»Šæ—¥ç›®æ ‡è¾¾æˆï¼
                </div>
                <div style="font-size: 15px; color: var(--text);">
                    ${appState.catName}ä¼šä¸€ç›´é™ªç€ä½ å“¦~
                </div>
            `;
            
            document.body.appendChild(popup);
            
            // çŒ«å’ªå¼€å¿ƒåŠ¨ç”»
            cat.classList.add('happy');
            setTimeout(() => cat.classList.remove('happy'), 2000);
            
            setTimeout(() => {
                popup.classList.add('hide');
                setTimeout(() => popup.remove(), 300);
            }, 3000);
        }
        
        function showCatQuestion() {
            // æ ¹æ®æ—¶é—´æ®µé€‰æ‹©é—®é¢˜åº“
            const timeBasedQuestions = getTimeBasedQuestions();
            const allQuestions = [...timeBasedQuestions, ...catQuestions.general];
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªé—®é¢˜
            const question = allQuestions[Math.floor(Math.random() * allQuestions.length)];
            
            const popup = document.createElement('div');
            popup.className = 'reward-popup cat-question-popup';
            popup.style.maxWidth = '320px';
            
            popup.innerHTML = `
                <div style="font-size: 40px; margin-bottom: 15px;">ğŸ±</div>
                <div style="font-size: 16px; color: var(--text); margin-bottom: 20px; line-height: 1.5;">
                    ${question.q}
                </div>
                <div class="question-answers">
                    ${question.a.map((ans, idx) => `
                        <button class="answer-btn" data-index="${idx}" data-answer="${ans}">
                            ${ans}
                        </button>
                    `).join('')}
                </div>
            `;
            
            document.body.appendChild(popup);
            
            // ç­”æ¡ˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            const answerBtns = popup.querySelectorAll('.answer-btn');
            answerBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const answer = btn.dataset.answer;
                    
                    // è®°ä½å¯¹è¯å†å²
                    conversationHistory.push({
                        question: question.q,
                        answer: answer,
                        timestamp: Date.now()
                    });
                    
                    // çŒ«å’ªçš„å„ç§å¯çˆ±ååº”
                    const responses = [
                        'å–µ~ æˆ‘æ‡‚äº†ï¼',
                        'åŸæ¥å¦‚æ­¤å–µ~',
                        'å¥½çš„å¥½çš„ï¼',
                        'å—¯å—¯ï¼Œè®°ä½äº†ï¼',
                        'è°¢è°¢å‘Šè¯‰æˆ‘å–µ~',
                        'å˜¿å˜¿ï¼ŒçŸ¥é“å•¦~',
                        'è¿™æ ·å‘€ï¼',
                        'äº†è§£äº†è§£~'
                    ];
                    
                    // æ ¹æ®ç­”æ¡ˆå†…å®¹ç»™å‡ºä¸åŒçš„ååº”
                    let response;
                    if (answer.includes('å¥½') || answer.includes('æ˜¯') || answer.includes('ç¡å¾—')) {
                        response = ['å¤ªå¥½å•¦å–µ~', 'çœŸæ£’ï¼', 'æˆ‘ä¹Ÿå¾ˆå¼€å¿ƒ~'][Math.floor(Math.random() * 3)];
                    } else if (answer.includes('ç´¯') || answer.includes('å›°') || answer.includes('ä¸')) {
                        response = ['è¦å¥½å¥½ä¼‘æ¯å“¦~', 'é‚£å–ç‚¹æ°´ä¼šèˆ’æœäº›', 'é™ªä½ ~'][Math.floor(Math.random() * 3)];
                    } else {
                        response = responses[Math.floor(Math.random() * responses.length)];
                    }
                    
                    popup.innerHTML = `
                        <div style="font-size: 50px; margin-bottom: 15px;">ğŸ˜¸</div>
                        <div style="font-size: 18px; color: var(--primary);">${response}</div>
                    `;
                    
                    // å¢åŠ ä¸€ç‚¹å¿«ä¹å€¼
                    appState.happy = Math.min(100, appState.happy + 3);
                    updateStatusBars();
                    
                    setTimeout(() => {
                        popup.classList.add('hide');
                        setTimeout(() => popup.remove(), 300);
                    }, 1500);
                });
            });
            
            // 10ç§’åè‡ªåŠ¨å…³é—­
            setTimeout(() => {
                if (document.body.contains(popup)) {
                    popup.classList.add('hide');
                    setTimeout(() => popup.remove(), 300);
                }
            }, 10000);
        }
        
        function updateStatusBars() {
            hungerBar.style.width = appState.hunger + '%';
            happyBar.style.width = appState.happy + '%';
            healthBar.style.width = appState.health + '%';
            
            hungerValue.textContent = Math.floor(appState.hunger);
            happyValue.textContent = Math.floor(appState.happy);
            healthValue.textContent = Math.floor(appState.health);
            
            // æ›´æ–°çŒ«å’ªçŠ¶æ€
            if (appState.hunger < 30) {
                cat.classList.add('hungry');
            } else {
                cat.classList.remove('hungry');
            }
            
            if (appState.happy < 40) {
                cat.classList.add('sad');
            } else {
                cat.classList.remove('sad');
            }
        }
        
        // æ—¶é—´æµé€æ•ˆæœ - æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
        setInterval(() => {
            const now = Date.now();
            
            // æ£€æŸ¥ç¡çœ çŠ¶æ€
            checkSleepStatus();
            
            // å¦‚æœåœ¨ç¡è§‰æˆ–å·²å®Œæˆç›®æ ‡ï¼Œä¸è¿›è¡Œæ•°å€¼è¡°å‡
            if (appState.isSleeping || appState.goalCompleted) {
                return;
            }
            
            // è®¡ç®—è·ç¦»ä¸Šæ¬¡è¡°å‡çš„æ—¶é—´
            const timeSinceLastDecay = now - appState.lastDecayTime;
            const minutesPassed = timeSinceLastDecay / (1000 * 60);
            
            // æ¯10åˆ†é’Ÿè¡°å‡ä¸€æ¬¡
            if (minutesPassed >= 10) {
                appState.lastDecayTime = now;
                
                // æ ¹æ®è·ç¦»ä¸Šæ¬¡å–æ°´çš„æ—¶é—´å†³å®šè¡°å‡é€Ÿåº¦
                const timeSinceLastDrink = now - appState.lastDrinkTime;
                const hoursSinceDrink = timeSinceLastDrink / (1000 * 60 * 60);
                
                let decayMultiplier = 1.0;
                if (hoursSinceDrink > 2) {
                    decayMultiplier = 2.0; // è¶…è¿‡2å°æ—¶ä¸å–æ°´ï¼Œè¡°å‡åŠ å€
                } else if (hoursSinceDrink > 1) {
                    decayMultiplier = 1.5; // è¶…è¿‡1å°æ—¶ï¼Œè¡°å‡1.5å€
                }
                
                // æ•°å€¼è¡°å‡
                appState.hunger = Math.max(0, appState.hunger - 3 * decayMultiplier);
                appState.happy = Math.max(0, appState.happy - 2 * decayMultiplier);
                appState.health = Math.max(0, appState.health - 1.5 * decayMultiplier);
                
                updateStatusBars();
                
                // å¦‚æœå¾ˆä¹…æ²¡å–æ°´ï¼ŒçŒ«å’ªä¼šåˆ°è¾¹ç¼˜æé†’
                if (hoursSinceDrink > 1.5 && appState.health < 60 && !appState.isSleeping) {
                    showThirstyReminder();
                }
            }
        }, 60000); // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
        
        function showThirstyReminder() {
            // çŒ«å’ªç§»åˆ°è¾¹ç¼˜
            cat.style.transition = 'left 1s ease';
            cat.style.left = '20%';
            
            // æ˜¾ç¤ºæç¤º
            const tip = document.createElement('div');
            tip.className = 'cooldown-tip-center';
            tip.textContent = 'å–µ~ å¥½æ¸´å‘€...';
            tip.style.background = 'rgba(255, 107, 157, 0.95)';
            catContainer.appendChild(tip);
            
            setTimeout(() => {
                cat.style.left = '50%';
                tip.remove();
            }, 3000);
        }
        
        // è®¾ç½®é¡µé¢åŠŸèƒ½
        const catNameInput = document.getElementById('catName');
        const userHeight = document.getElementById('userHeight');
        const userWeight = document.getElementById('userWeight');
        const targetWater = document.getElementById('targetWater');
        const sipsSizeSelect = document.getElementById('sipsSize');
        
        function calculateTargetWater() {
            const weight = parseInt(userWeight.value) || 60;
            const targetMl = weight * 30; // 30ml/kg
            targetWater.textContent = targetMl;
            
            // æ ¹æ®é€‰æ‹©çš„æ¯æ¬¡å–æ°´é‡è®¡ç®—ç›®æ ‡æ¬¡æ•°
            const mlPerSip = parseInt(sipsSizeSelect.value);
            appState.mlPerSip = mlPerSip;
            appState.targetSips = Math.ceil(targetMl / mlPerSip);
            appState.settings.sipsSize = mlPerSip;
            
            // æ›´æ–°æ˜¾ç¤º
            updateProgress();
            
            return targetMl;
        }
        
        userHeight.addEventListener('input', () => {
            appState.settings.height = parseInt(userHeight.value);
            calculateTargetWater();
        });
        
        userWeight.addEventListener('input', () => {
            appState.settings.weight = parseInt(userWeight.value);
            calculateTargetWater();
        });
        
        sipsSizeSelect.addEventListener('change', () => {
            calculateTargetWater();
        });
        
        catNameInput.addEventListener('input', () => {
            appState.catName = catNameInput.value;
        });
        
        // å¼€å…³æŒ‰é’®
        const toggles = document.querySelectorAll('.toggle-switch');
        toggles.forEach(toggle => {
            toggle.addEventListener('click', () => {
                toggle.classList.toggle('active');
                
                const settingName = toggle.id.replace('Toggle', '');
                
                // é€šçŸ¥å¼€å…³ç‰¹æ®Šå¤„ç†
                if (settingName === 'notification') {
                    const isActive = toggle.classList.contains('active');
                    appState.settings.notifications = isActive;
                    
                    if (isActive) {
                        // è¯·æ±‚é€šçŸ¥æƒé™å¹¶å¼€å¯æé†’
                        requestNotificationPermission().then(() => {
                            if (notificationPermission === 'granted') {
                                startReminder(60); // 60åˆ†é’Ÿæé†’ä¸€æ¬¡
                                sendNotification('ğŸ‰ æé†’å·²å¼€å¯', 'æˆ‘ä¼šæ¯å°æ—¶æé†’ä½ å–æ°´å“¦~');
                            } else {
                                // æƒé™è¢«æ‹’ç»ï¼Œå…³é—­å¼€å…³
                                toggle.classList.remove('active');
                                appState.settings.notifications = false;
                                alert('éœ€è¦å¼€å¯é€šçŸ¥æƒé™æ‰èƒ½ä½¿ç”¨æé†’åŠŸèƒ½å“¦~\n\nè¯·åœ¨æ‰‹æœºè®¾ç½®ä¸­å…è®¸é€šçŸ¥');
                            }
                        });
                    } else {
                        // å…³é—­æé†’
                        stopReminder();
                    }
                } else if (appState.settings.hasOwnProperty(settingName)) {
                    appState.settings[settingName] = toggle.classList.contains('active');
                }
            });
        });
        
        // æ·»åŠ è®°å½•æŒ‰é’®
        const addRecordBtn = document.querySelector('.add-record-btn');
        addRecordBtn.addEventListener('click', () => {
            openEditModal();
        });
        
        // æ—¶é—´è½´ç¼–è¾‘æŒ‰é’®
        function attachEditListeners() {
            const editBtns = document.querySelectorAll('.timeline-edit');
            editBtns.forEach(btn => {
                btn.onclick = (e) => {
                    e.stopPropagation();
                    const recordId = parseInt(btn.dataset.id);
                    openEditModal(recordId);
                };
            });
        }
        
        // ç¼–è¾‘è®°å½•åŠŸèƒ½
        const editModal = document.getElementById('editModal');
        const modalTitle = document.getElementById('modalTitle');
        const editForm = document.getElementById('editForm');
        const editTime = document.getElementById('editTime');
        const editType = document.getElementById('editType');
        const editContent = document.getElementById('editContent');
        const editIcon = document.getElementById('editIcon');
        const cancelBtn = document.getElementById('cancelBtn');
        const deleteBtn = document.getElementById('deleteBtn');
        
        function openEditModal(recordId = null) {
            if (recordId) {
                // ç¼–è¾‘ç°æœ‰è®°å½•
                const record = appState.waterRecords.find(r => r.id === recordId);
                if (record) {
                    modalTitle.textContent = 'ç¼–è¾‘è®°å½•';
                    editTime.value = record.time;
                    editType.value = record.type;
                    editContent.value = record.content;
                    editIcon.value = record.icon;
                    deleteBtn.style.display = 'block';
                    appState.currentEditId = recordId;
                }
            } else {
                // æ·»åŠ æ–°è®°å½•
                modalTitle.textContent = 'æ·»åŠ è®°å½•';
                editForm.reset();
                const now = new Date();
                editTime.value = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
                deleteBtn.style.display = 'none';
                appState.currentEditId = null;
            }
            editModal.classList.add('show');
        }
        
        function closeEditModal() {
            editModal.classList.remove('show');
            editForm.reset();
            appState.currentEditId = null;
        }
        
        cancelBtn.addEventListener('click', closeEditModal);
        
        editModal.addEventListener('click', (e) => {
            if (e.target === editModal) {
                closeEditModal();
            }
        });
        
        editForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const record = {
                time: editTime.value,
                type: editType.value,
                content: editContent.value,
                icon: editIcon.value
            };
            
            if (appState.currentEditId) {
                // æ›´æ–°ç°æœ‰è®°å½•
                const index = appState.waterRecords.findIndex(r => r.id === appState.currentEditId);
                if (index !== -1) {
                    appState.waterRecords[index] = {
                        ...appState.waterRecords[index],
                        ...record
                    };
                }
            } else {
                // æ·»åŠ æ–°è®°å½•
                const newId = Math.max(...appState.waterRecords.map(r => r.id), 0) + 1;
                appState.waterRecords.push({
                    id: newId,
                    ...record
                });
            }
            
            // æŒ‰æ—¶é—´æ’åº
            appState.waterRecords.sort((a, b) => a.time.localeCompare(b.time));
            
            renderWaterRecords();
            closeEditModal();
        });
        
        deleteBtn.addEventListener('click', () => {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ')) {
                appState.waterRecords = appState.waterRecords.filter(r => r.id !== appState.currentEditId);
                renderWaterRecords();
                closeEditModal();
            }
        });
        
        // æ¸²æŸ“é¥®æ°´è®°å½•
        function renderWaterRecords() {
            const timeline = document.querySelector('.timeline');
            timeline.innerHTML = '';
            
            appState.waterRecords.forEach(record => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                item.innerHTML = `
                    <div class="timeline-time">${record.time}</div>
                    <div class="timeline-content">
                        <div class="timeline-icon">${record.icon}</div>
                        <div class="timeline-text">
                            <div class="timeline-type">${record.type}</div>
                            <div class="timeline-note">${record.content}</div>
                        </div>
                        <button class="timeline-edit" data-id="${record.id}">âœï¸</button>
                    </div>
                `;
                timeline.appendChild(item);
            });
            
            attachEditListeners();
        }
        
        // åˆå§‹åŒ–æ¸²æŸ“
        renderWaterRecords();
        
        // åˆå§‹åŒ–
        calculateTargetWater();
        updateStatusBars();
        updateProgress();
        checkSleepStatus(); // æ£€æŸ¥å½“å‰æ˜¯å¦åº”è¯¥ç¡è§‰
        
        // å¦‚æœé€šçŸ¥å¼€å…³æ˜¯æ‰“å¼€çš„ï¼Œè‡ªåŠ¨è¯·æ±‚æƒé™
        if (appState.settings.notifications) {
            requestNotificationPermission().then(() => {
                if (notificationPermission === 'granted') {
                    startReminder(60);
                }
            });
        }
        
        // æ¬¢è¿åŠ¨ç”»ï¼ˆå¦‚æœä¸åœ¨ç¡è§‰ï¼‰
        setTimeout(() => {
            if (!appState.isSleeping) {
                cat.classList.add('happy');
                setTimeout(() => {
                    cat.classList.remove('happy');
                }, 1000);
            }
        }, 500);
        
        console.log('ğŸ± å–µå–µå–æ°´ App åŸå‹å·²å¯åŠ¨ï¼');
        console.log('');
        console.log('ğŸ”” é€šçŸ¥åŠŸèƒ½ï¼š');
        console.log('- åœ¨è®¾ç½®é¡µé¢æ‰“å¼€"å¼€å¯æé†’"');
        console.log('- å…è®¸æµè§ˆå™¨å‘é€é€šçŸ¥');
        console.log('- æ¯60åˆ†é’Ÿä¼šæ”¶åˆ°å–æ°´æé†’');
        console.log('- Safariæ·»åŠ åˆ°ä¸»å±å¹•åä¹Ÿèƒ½æ”¶åˆ°é€šçŸ¥');
        console.log('');
        console.log('ğŸ’§ å–æ°´é‡è®¾ç½®ï¼ˆå¯åœ¨è®¾ç½®é¡µè°ƒæ•´ï¼‰ï¼š');
        console.log('- å°å£ï¼ˆ75ml/æ¬¡ï¼‰ï¼šçº¦3å£æ°´');
        console.log('- æ­£å¸¸ï¼ˆ100ml/æ¬¡ï¼‰ï¼šçº¦4å£æ°´ âœ“');
        console.log('- å¤§å£ï¼ˆ150ml/æ¬¡ï¼‰ï¼šçº¦6å£æ°´');
        console.log('');
        console.log('ğŸ›¡ï¸ é˜²ä½œå¼Šæœºåˆ¶ï¼š');
        console.log('- å‰3æ¬¡ï¼šæ­£å¸¸å–æ°´ï¼Œ100%å¥–åŠ±');
        console.log('- ç¬¬4æ¬¡èµ·ï¼šé€æ¸é™ä½å¥–åŠ±');
        console.log('- ç­‰å¾…2åˆ†é’Ÿåè‡ªåŠ¨æ¢å¤');
        console.log('');
        console.log('ğŸ® è¯•è¯•çœ‹ï¼š');
        console.log('- å»è®¾ç½®é¡µæ‰“å¼€"å¼€å¯æé†’"æµ‹è¯•é€šçŸ¥');
        console.log('- è¿ç»­ç‚¹å‡»4æ¬¡çœ‹æç¤ºå˜åŒ–');
        console.log('- é•¿æŒ‰çŒ«å’ªçœ‹å®ƒç¿»è‚šçš®');
    </script>
</body>
</html>
